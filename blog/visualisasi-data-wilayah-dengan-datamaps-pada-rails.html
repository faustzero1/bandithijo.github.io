<!DOCTYPE html>
<html lang="id">

<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Here's where I started writing some notes that someday I will call it, a book">
<meta name="keywords" content="tips, javascript, rails">
<meta name="author" content="Rizqi Nur Assyaufi">
<meta name="theme-color" content="#008352">
<meta name="msapplication-navbutton-color" content="#008352">
<meta name="apple-mobile-web-app-status-bar-style" content="#008352">
<title>Visualisasi Data Wilayah dengan Datamaps pada Rails | BanditHijo (R)-Chive</title>
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="stylesheet" href="/assets/css/github-markdown-bandit.css">
<link rel="icon" href="/assets/img/favicon/favicon.png" type="image/png">
<link rel="manifest" href="/manifest.json">

  <!-- Begin Jekyll SEO tag v2.6.1 -->
<meta name="generator" content="Jekyll v4.2.2" />
<meta property="og:title" content="Visualisasi Data Wilayah dengan Datamaps pada Rails" />
<meta name="author" content="BanditHijo" />
<meta property="og:locale" content="id" />
<meta name="description" content="Mungkin teman-teman pernah melihat interaktif peta yang memvisualisasikan data tertentu, misal data jumlah penduduk setiap provinsi yang ditampilkan dalam bentuk peta. Catatan kali ini saya akan membahas bagaimana cara membuat hal tersebut dengan datamaps Javascript library pada Rails." />
<meta property="og:description" content="Mungkin teman-teman pernah melihat interaktif peta yang memvisualisasikan data tertentu, misal data jumlah penduduk setiap provinsi yang ditampilkan dalam bentuk peta. Catatan kali ini saya akan membahas bagaimana cara membuat hal tersebut dengan datamaps Javascript library pada Rails." />
<link rel="canonical" href="https://bandithijo.dev/blog/visualisasi-data-wilayah-dengan-datamaps-pada-rails" />
<meta property="og:url" content="https://bandithijo.dev/blog/visualisasi-data-wilayah-dengan-datamaps-pada-rails" />
<meta property="og:site_name" content="BanditHijo (R)-Chive" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-02-07T23:48:00+08:00" />
<script type="application/ld+json">
{"author":{"@type":"Person","name":"BanditHijo"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://bandithijo.dev/blog/visualisasi-data-wilayah-dengan-datamaps-pada-rails"},"description":"Mungkin teman-teman pernah melihat interaktif peta yang memvisualisasikan data tertentu, misal data jumlah penduduk setiap provinsi yang ditampilkan dalam bentuk peta. Catatan kali ini saya akan membahas bagaimana cara membuat hal tersebut dengan datamaps Javascript library pada Rails.","url":"https://bandithijo.dev/blog/visualisasi-data-wilayah-dengan-datamaps-pada-rails","@type":"BlogPosting","headline":"Visualisasi Data Wilayah dengan Datamaps pada Rails","dateModified":"2021-02-07T23:48:00+08:00","datePublished":"2021-02-07T23:48:00+08:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  <meta property="og:country-name"   content="Indonesia"/>
<meta property="og:image"          content="https://bandithijo.dev/assets/img/banner/bndt_banner.png"/>
<meta property="og:image:width"    content="460"/>
<meta property="og:image:height"   content="230"/>

<meta property="twitter:card"      content="summary_large_image"/>
<meta property="twitter:title"     content="Visualisasi Data Wilayah dengan Datamaps pada Rails"/>
<meta property="twitter:author"    content="BanditHijo"/>
<meta property="twitter:image:src" content="https://bandithijo.dev/assets/img/banner/bndt_banner.png"/>

  <!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-116004889-1', 'auto');
ga('send', 'pageview');
</script>
<!-- End Google Analytics -->

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-688BWZGJ84"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-688BWZGJ84');
</script>
<!-- End Google tag (gtag.js) -->

  <meta name="google-site-verification" content="qXp9Kgb5hIHVp5T9vFOa_motqUmNuF5STbkJKF70wLc">

</head>


<body>

<header id="header" class="noselect">
  <div class="container container-strip">
    <div class="container-inner container-inner-strip">
    <div class="logo">
      <img src="/assets/img/logo/logo_bandithijo.png">
    </div>

    <div class="title">
      <h1><span class="nobr">BanditHijo (R)-Chive</span></h1>
    </div>
    <div class="description">
      <h2>Here's where I started writing some notes that someday <span class="nobr">I will call it, a book</span></h2>
      <br>
      <span class="emblem-f">TECHNICAL<span class="emblem-e">BLOG : JOURNAL</span></span>
    </div>

    <nav class="nav nav-strip">
      <div class="toggle">
        <div class="menu" onmouseover="this.style.cursor='pointer'" onclick="navBtn()">
          <span class="menu-title">BANDITHIJO</span>
          <img style="width:30px;" src="/assets/img/logo/logo_menu.svg" id="nav-btn">
        </div><!-- menu -->
      </div><!-- toggle -->
      <ul id="menu-ul">
        <li><a href="/">Home</a></li>
        
        
        
        <li><a href="/blog/" class="active">Blog</a></li>
        
        
        
        <li><a href="/note/" class="">Note</a></li>
        
        
        
        <li><a href="https://www.youtube.com/c/BanditHijo" class="">Vlog</a></li>
        
        
        
        <li><a href="/book/" class="">Books</a></li>
        
        
        
        <li><a href="/lab/" class="">Lab</a></li>
        
        
        
        <li><a href="/about/" class="">About</a></li>
        
      </ul>
    </nav>
    </div><!-- container-inner -->
  </div><!-- header container -->
</header>


<section id="main">
  <div class="container">
    <div class="container-edge-border">

      

      <article class="post-pre-title">
        <div class="post-body">
          
            <h1 class="post-title"><a href="/blog/visualisasi-data-wilayah-dengan-datamaps-pada-rails">Visualisasi Data Wilayah dengan Datamaps pada Rails</a></h1>
          
          <label class="hideAside noselect" title="On/Off Sidebar" onclick="toggleShowHideSidebar()"><img style="width:20px;margin-top:5px;" src="/assets/img/logo/logo_menu.svg" alt=""></label>

          
          
          
            <span class="post-details noselect">Ditulis: 2021/02/07</span> <span class="post-details noselect">Diperbaharui: 2022/09/23</span>
          

          <div class="breadcrumbs noselect">

<span style="color:#232323;">&#9654;</span>&nbsp;<a href="/">Home</a>

  
    / <a href="/blog/">Blog</a>
  

  
    / Visualisasi data wilayah dengan datamaps pada rails
  

</div>

          <div class="tags-in-post noselect">
  
  
    <span class="tags"><a href="https://bandithijo.dev/tags/#javascript">Javascript</a></span>
  
    <span class="tags"><a href="https://bandithijo.dev/tags/#rails">Rails</a></span>
  
    <span class="tags"><a href="https://bandithijo.dev/tags/#tips">Tips</a></span>
  
</div>

        </div>
      </article>

      <article>
        <div class="post-body-sidebar">
          <aside class="sidebar noselect" id="sidebar-head">

    <div class="sidebar-body">
  <h1 style="font-size:1.5em;border-bottom:1px dashed #9E9E9E;">
    <img src="/assets/img/logo/logo_toc.svg">Daftar Isi
  </h1>
  <div class="toc">
    
    <ul>
  <li><a href="#prerequisite">Prerequisite</a></li>
  <li><a href="#latar-belakang">Latar Belakang</a></li>
  <li><a href="#permasalahan">Permasalahan</a></li>
  <li><a href="#pemecahan-masalah">Pemecahan Masalah</a>
    <ul>
      <li><a href="#actioncontroller">ActionController</a>
        <ul>
          <li><a href="#mengkonversi-nama-provinsi-ke-kode-provinsi">Mengkonversi Nama Provinsi ke Kode Provinsi</a></li>
          <li><a href="#mengklasifikasi-total_cases-berdasaran-warna">Mengklasifikasi total_cases Berdasaran Warna</a></li>
          <li><a href="#memberikan-delimiter--untuk-ribuan">Memberikan Delimiter , untuk Ribuan</a></li>
        </ul>
      </li>
      <li><a href="#actionview">ActionView</a></li>
    </ul>
  </li>
  <li><a href="#pesan-penulis">Pesan Penulis</a></li>
  <li><a href="#referensi">Referensi</a></li>
</ul>

  </div>
</div>


</aside>

        </div>
      </article>

      <article class="post">
        <div class="post-body">
          <div class="doa-awal noselect">
<p><img src="/assets/img/logo/logo_doa_awal.svg" alt="بسم الله الرحمن الرحيم" style="height:40px" align="right"></p>
<div style="clear:both;"></div>
</div>

        </div>
        <div class="markdown-body highlight">

          <!-- The Modal -->
<div class="modal">
  <img class="modal-content">
</div>


          <p><h1 id="prerequisite">Prerequisite</h1>

<p><code class="language-plaintext highlighter-rouge">ruby 2.7.2</code> <code class="language-plaintext highlighter-rouge">rails 6.1.1</code> <code class="language-plaintext highlighter-rouge">datamaps 0.5.9</code></p>

<h1 id="latar-belakang">Latar Belakang</h1>

<p>Misalkan saya memiliki sebuah data peta sebaran kasus kumulativ COVID-19 seluruh provinsi di Indonesia.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">fetched_at</th>
      <th style="text-align: left">name</th>
      <th style="text-align: right">total_cases</th>
      <th style="text-align: right">total_recovered</th>
      <th style="text-align: right">total_deaths</th>
      <th style="text-align: right">active_cases</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">2021-02-07</td>
      <td style="text-align: left">DKI Jakarta</td>
      <td style="text-align: right">293825</td>
      <td style="text-align: right">265291</td>
      <td style="text-align: right">4573</td>
      <td style="text-align: right">23961</td>
    </tr>
    <tr>
      <td style="text-align: left">2021-02-07</td>
      <td style="text-align: left">Jawa Barat</td>
      <td style="text-align: right">167707</td>
      <td style="text-align: right">134255</td>
      <td style="text-align: right">2039</td>
      <td style="text-align: right">31413</td>
    </tr>
    <tr>
      <td style="text-align: left">2021-02-07</td>
      <td style="text-align: left">Jawa Tengah</td>
      <td style="text-align: right">135552</td>
      <td style="text-align: right">86400</td>
      <td style="text-align: right">5646</td>
      <td style="text-align: right">43506</td>
    </tr>
    <tr>
      <td style="text-align: left">2021-02-07</td>
      <td style="text-align: left">Jawa Timur</td>
      <td style="text-align: right">117851</td>
      <td style="text-align: right">103219</td>
      <td style="text-align: right">8152</td>
      <td style="text-align: right">6480</td>
    </tr>
    <tr>
      <td style="text-align: left">2021-02-07</td>
      <td style="text-align: left">Jawa Timur</td>
      <td style="text-align: right">117851</td>
      <td style="text-align: right">103219</td>
      <td style="text-align: right">8152</td>
      <td style="text-align: right">6480</td>
    </tr>
    <tr>
      <td style="text-align: left">…</td>
      <td style="text-align: left">…</td>
      <td style="text-align: right">…</td>
      <td style="text-align: right">…</td>
      <td style="text-align: right">…</td>
      <td style="text-align: right">…</td>
    </tr>
  </tbody>
</table>

<p>Saya ingin membuat sebuah visualisasi data peta Indonesia yang terbagi-bagi berdasarkan wilayah provinsi. Kemudian pada masing-masing provinsi tersebut menampilkan data total kasus (total_cases).</p>

<p>Kira-kira ilustrasinya seperti ini:</p>

<div style="overflow:auto;">
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.3/d3.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/topojson/1.6.9/topojson.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/datamaps/0.5.9/datamaps.idn.min.js"></script>

<div id="container1" style="position: relative; width: 890px; height: 400px; margin: 0 auto;"></div>

<script type="text/javascript">
//basic map config with custom fills, mercator projection
var map = new Datamap({
scope: 'idn',
element: document.getElementById('container1'),
setProjection: function (element) {
var projection = d3.geo.mercator()
.center([120, -5])
.rotate([0, 0])
.scale(4000 / 4)
var path = d3.geo.path()
.projection(projection);
return {path: path, projection: projection};
},
fills: {
defaultFill: '#dddddd',
'AAA': '#DB1836',
'BBB': '#F15A23',
'CCC': '#F89A1C',
'DDD': '#FFD500',
'EEE': '#C1D737',
'FFF': '#44B549',
'GGG': '#0EB049',
'HHH': '#016533',
},
data: {
'ID.AC': {fillKey: 'AAA', totalCases: '12.345'},
'ID.BA': {fillKey: 'AAA', totalCases: '12.345'},
'ID.BT': {fillKey: 'AAA', totalCases: '12.345'},
'ID.BE': {fillKey: 'BBB', totalCases: '12.345'},
'ID.JK': {fillKey: 'BBB', totalCases: '12.345'},
'ID.YO': {fillKey: 'BBB', totalCases: '12.345'},
'ID.GO': {fillKey: 'CCC', totalCases: '12.345'},
'ID.JA': {fillKey: 'CCC', totalCases: '12.345'},
'ID.JR': {fillKey: 'CCC', totalCases: '12.345'},
'ID.JT': {fillKey: 'DDD', totalCases: '12.345'},
'ID.JI': {fillKey: 'DDD', totalCases: '12.345'},
'ID.KB': {fillKey: 'DDD', totalCases: '12.345'},
'ID.KS': {fillKey: 'EEE', totalCases: '12.345'},
'ID.KT': {fillKey: 'EEE', totalCases: '12.345'},
'ID.KI': {fillKey: 'EEE', totalCases: '12.345'},
'ID.KU': {fillKey: 'CCC', totalCases: '12.345'},
'ID.BB': {fillKey: 'CCC', totalCases: '12.345'},
'ID.KR': {fillKey: 'CCC', totalCases: '12.345'},
'ID.LA': {fillKey: 'FFF', totalCases: '12.345'},
'ID.MU': {fillKey: 'FFF', totalCases: '12.345'},
'ID.MA': {fillKey: 'FFF', totalCases: '12.345'},
'ID.NB': {fillKey: 'GGG', totalCases: '12.345'},
'ID.NT': {fillKey: 'GGG', totalCases: '12.345'},
'ID.IB': {fillKey: 'GGG', totalCases: '12.345'},
'ID.PA': {fillKey: 'HHH', totalCases: '12.345'},
'ID.RI': {fillKey: 'HHH', totalCases: '12.345'},
'ID.SR': {fillKey: 'HHH', totalCases: '12.345'},
'ID.SE': {fillKey: 'FFF', totalCases: '12.345'},
'ID.ST': {fillKey: 'FFF', totalCases: '12.345'},
'ID.SG': {fillKey: 'FFF', totalCases: '12.345'},
'ID.SW': {fillKey: 'FFF', totalCases: '12.345'},
'ID.SB': {fillKey: 'GGG', totalCases: '12.345'},
'ID.SL': {fillKey: 'GGG', totalCases: '12.345'},
'ID.SU': {fillKey: 'GGG', totalCases: '12.345'}
},
geographyConfig: {
popupTemplate: function(geo, data) {
return ['<div class="hoverinfo"><strong>',
geo.properties.name + '</strong><br>Kasus (Kulumatif)',
': ' + data.totalCases,
'</div>'].join('');
}
}
});
</script>
</div>

<p>Visualisasi peta di atas menggunakan bantuan <strong>datamaps</strong> yang menggunakan <strong>D3.js</strong> library.</p>

<blockquote>
  <p><em>Datamaps is intended to provide some data visualizations based on geographical data. It’s <strong>SVG-based</strong>, can scale to any screen size, and includes everything inside of 1 script file. It heavily relies on the amazing <strong>D3.js</strong> library</em>.</p>
</blockquote>

<h1 id="permasalahan">Permasalahan</h1>

<p>Bagaimana caranya menghubungkan data yang ada di database Rails, dengan datamaps.</p>

<h1 id="pemecahan-masalah">Pemecahan Masalah</h1>

<p>Kalau kita lihat pada bagian <code class="language-plaintext highlighter-rouge">data: {...}</code>,</p>

<div class="highlight-caption"><span class="label">FILE</span><code>app/views/data_peta/index.html.erb</code></div>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="code"><pre><span class="c1">// ...</span>

    <span class="nx">fills</span><span class="p">:</span> <span class="p">{</span>
      <span class="nl">defaultFill</span><span class="p">:</span> <span class="dl">'</span><span class="s1">#dddddd</span><span class="dl">'</span><span class="p">,</span>
      <span class="dl">'</span><span class="s1">AAA</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">#DB1836</span><span class="dl">'</span><span class="p">,</span>
      <span class="dl">'</span><span class="s1">BBB</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">#F15A23</span><span class="dl">'</span><span class="p">,</span>
      <span class="dl">'</span><span class="s1">CCC</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">#F89A1C</span><span class="dl">'</span><span class="p">,</span>
      <span class="dl">'</span><span class="s1">DDD</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">#FFD500</span><span class="dl">'</span><span class="p">,</span>
      <span class="c1">// ...</span>
    <span class="p">},</span>
    <span class="nx">data</span><span class="p">:</span> <span class="p">{</span>
      <span class="dl">'</span><span class="s1">ID.AC</span><span class="dl">'</span><span class="p">:</span> <span class="p">{</span><span class="nl">fillKey</span><span class="p">:</span> <span class="dl">'</span><span class="s1">AAA</span><span class="dl">'</span><span class="p">,</span> <span class="nx">totalCases</span><span class="p">:</span> <span class="dl">'</span><span class="s1">12.345</span><span class="dl">'</span><span class="p">},</span>
      <span class="dl">'</span><span class="s1">ID.BA</span><span class="dl">'</span><span class="p">:</span> <span class="p">{</span><span class="nl">fillKey</span><span class="p">:</span> <span class="dl">'</span><span class="s1">BBB</span><span class="dl">'</span><span class="p">,</span> <span class="nx">totalCases</span><span class="p">:</span> <span class="dl">'</span><span class="s1">12.345</span><span class="dl">'</span><span class="p">},</span>
      <span class="dl">'</span><span class="s1">ID.BT</span><span class="dl">'</span><span class="p">:</span> <span class="p">{</span><span class="nl">fillKey</span><span class="p">:</span> <span class="dl">'</span><span class="s1">CCC</span><span class="dl">'</span><span class="p">,</span> <span class="nx">totalCases</span><span class="p">:</span> <span class="dl">'</span><span class="s1">12.345</span><span class="dl">'</span><span class="p">},</span>
      <span class="dl">'</span><span class="s1">ID.BE</span><span class="dl">'</span><span class="p">:</span> <span class="p">{</span><span class="nl">fillKey</span><span class="p">:</span> <span class="dl">'</span><span class="s1">DDD</span><span class="dl">'</span><span class="p">,</span> <span class="nx">totalCases</span><span class="p">:</span> <span class="dl">'</span><span class="s1">12.345</span><span class="dl">'</span><span class="p">},</span>
      <span class="c1">// ...</span>
    <span class="p">},</span>
</pre></td></tr></tbody></table></code></pre></figure>

<p>Data contohnya seperti di atas.</p>

<p>Kita akan mengganti data statis tersebut dengan data yang ada di database yang kita miliki.</p>

<h2 id="actioncontroller">ActionController</h2>

<p>Kalau melihat format data di atas pada baris 12-15, <code class="language-plaintext highlighter-rouge">data: {...}</code> tersebut memiliki format persatuan data, seperti ini:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="dl">'</span><span class="s1">ID.AC</span><span class="dl">'</span><span class="p">:</span> <span class="p">{</span><span class="nl">fillKey</span><span class="p">:</span> <span class="dl">'</span><span class="s1">AAA</span><span class="dl">'</span><span class="p">,</span> <span class="nx">totalCases</span><span class="p">:</span> <span class="dl">'</span><span class="s1">12.345</span><span class="dl">'</span><span class="p">},</span>
</code></pre></div></div>

<p>Nah, artinya kita bisa membuat format seperti ini pada controller.</p>

<div class="highlight-caption"><span class="label">FILE</span><code>app/controllers/data_peta_controller.rb</code></div>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="code"><pre><span class="vi">@last_updated</span>     <span class="o">=</span> <span class="no">Province</span><span class="p">.</span><span class="nf">last</span><span class="p">.</span><span class="nf">fetched_at</span>
<span class="vi">@cumulative_cases</span> <span class="o">=</span> <span class="no">Province</span><span class="p">.</span><span class="nf">select</span><span class="p">(</span><span class="ss">:name</span><span class="p">,</span> <span class="ss">:total_cases</span><span class="p">)</span>
  <span class="p">.</span><span class="nf">where</span><span class="p">(</span><span class="ss">fetched_at: </span><span class="vi">@last_updated</span><span class="p">)</span>
  <span class="p">.</span><span class="nf">map</span> <span class="p">{</span> <span class="o">|</span><span class="n">n</span><span class="o">|</span>
    <span class="s2">"'</span><span class="si">#{</span><span class="n">n</span><span class="p">.</span><span class="nf">name</span><span class="si">}</span><span class="s2">': {fillKey: 'AAA', totalCases: 'n.total_cases'},</span><span class="se">\n</span><span class="s2">"</span>
  <span class="p">}.</span><span class="nf">join</span>
</pre></td></tr></tbody></table></code></pre></figure>

<p>Pada baris 1, saya mengambil tanggal dari data terakhir.</p>

<p>Baris 2, saya memanggil Object Province dan melakukan SELECT terhadap field yang diperlukan saja, yaitu field <code class="language-plaintext highlighter-rouge">:nama</code> dan <code class="language-plaintext highlighter-rouge">:total_cases</code>.</p>

<p>Baris 3, saya hanya mengambil data pada tanggal paling baru di database yang saya simpan pada variable @last_updated.</p>

<p>Baris 4-5 saya melakukan mapping untuk agar value yang dikembalikan dalam bentuk array.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">=&gt;</span> <span class="p">[</span><span class="s2">"'DKI Jakarta': {fillKey: 'AAA', totalCases: '293825'},</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span> <span class="s2">"'Jawa Barat': {fillKey: 'AAA', totalCases: '167707'},</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span> <span class="s2">"'Jawa Tengah': {fillKey: 'AAA', totalCas...
</span></code></pre></div></div>

<p>Baris 6, saya menggunakan method <code class="language-plaintext highlighter-rouge">.join</code> untuk membuat array mejadi string yang nantinya, pada view template, akan menggunakan method <code class="language-plaintext highlighter-rouge">raw()</code> untuk melakukan escaping string.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">=&gt;</span> <span class="s2">"'DKI Jakarta': {fillKey: 'AAA', totalCases: '293825'},</span><span class="se">\n</span><span class="s2">'Jawa Barat': {fillKey: 'AAA', totalCases: '167707'},</span><span class="se">\n</span><span class="s2">'Jawa Tengah': {fillKey: 'AAA', totalCases: '1355...
</span></code></pre></div></div>

<p><br /></p>
<h3 id="mengkonversi-nama-provinsi-ke-kode-provinsi">Mengkonversi Nama Provinsi ke Kode Provinsi</h3>

<p>Kalau teman-teman perhatikan, bagian nama provinsi dan <code class="language-plaintext highlighter-rouge">fillKey:</code> masih belum sesuai dengan format yang diperlukan.</p>

<p>Karena nama provinsi harus berupa kode ISO format dari provinsi tersebut,</p>

<p>Misal untuk Aceh berarti kodenya adalah <code class="language-plaintext highlighter-rouge">ID.AC</code>.</p>

<p>Lantas, kita perlu melakukan konversi terhadap data <code class="language-plaintext highlighter-rouge">:name</code> terlebih dahulu.</p>

<p>Caranya mudah, saya tinggal buatkan sebuah method baru yang saya beri nama,</p>

<p><code class="language-plaintext highlighter-rouge">convert_name_to_province_code(province_name)</code>.</p>

<p>Agar controller saya tetap bersih, saya akan menggunakan controller concern saja.</p>

<div class="highlight-caption"><span class="label">FILE</span><code>app/controllers/concerns/convert_name_to_province_code.rb</code></div>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
</pre></td><td class="code"><pre><span class="k">module</span> <span class="nn">ConvertProvNameToProvCode</span>
  <span class="k">def</span> <span class="nf">convert_name_to_province_code</span><span class="p">(</span><span class="n">province_name</span><span class="p">)</span>
    <span class="n">provinces</span> <span class="o">=</span> <span class="p">{</span>
      <span class="s1">'Aceh'</span>                       <span class="o">=&gt;</span> <span class="s1">'ID.AC'</span><span class="p">,</span>
      <span class="s1">'Bali'</span>                       <span class="o">=&gt;</span> <span class="s1">'ID.BA'</span><span class="p">,</span>
      <span class="s1">'Banten'</span>                     <span class="o">=&gt;</span> <span class="s1">'ID.BT'</span><span class="p">,</span>
      <span class="s1">'Bengkulu'</span>                   <span class="o">=&gt;</span> <span class="s1">'ID.BE'</span><span class="p">,</span>
      <span class="s1">'DKI Jakarta'</span>                <span class="o">=&gt;</span> <span class="s1">'ID.JK'</span><span class="p">,</span>
      <span class="s1">'Daerah Istimewa Yogyakarta'</span> <span class="o">=&gt;</span> <span class="s1">'ID.YO'</span><span class="p">,</span>
      <span class="s1">'Gorontalo'</span>                  <span class="o">=&gt;</span> <span class="s1">'ID.GO'</span><span class="p">,</span>
      <span class="s1">'Jambi'</span>                      <span class="o">=&gt;</span> <span class="s1">'ID.JA'</span><span class="p">,</span>
      <span class="s1">'Jawa Barat'</span>                 <span class="o">=&gt;</span> <span class="s1">'ID.JR'</span><span class="p">,</span>
      <span class="s1">'Jawa Tengah'</span>                <span class="o">=&gt;</span> <span class="s1">'ID.JT'</span><span class="p">,</span>
      <span class="s1">'Jawa Timur'</span>                 <span class="o">=&gt;</span> <span class="s1">'ID.JI'</span><span class="p">,</span>
      <span class="s1">'Kalimantan Barat'</span>           <span class="o">=&gt;</span> <span class="s1">'ID.KB'</span><span class="p">,</span>
      <span class="s1">'Kalimantan Selatan'</span>         <span class="o">=&gt;</span> <span class="s1">'ID.KS'</span><span class="p">,</span>
      <span class="s1">'Kalimantan Tengah'</span>          <span class="o">=&gt;</span> <span class="s1">'ID.KT'</span><span class="p">,</span>
      <span class="s1">'Kalimantan Timur'</span>           <span class="o">=&gt;</span> <span class="s1">'ID.KI'</span><span class="p">,</span>
      <span class="s1">'Kalimantan Utara'</span>           <span class="o">=&gt;</span> <span class="s1">'ID.KU'</span><span class="p">,</span>
      <span class="s1">'Kepulauan Bangka Belitung'</span>  <span class="o">=&gt;</span> <span class="s1">'ID.BB'</span><span class="p">,</span>
      <span class="s1">'Kepulauan Riau'</span>             <span class="o">=&gt;</span> <span class="s1">'ID.KR'</span><span class="p">,</span>
      <span class="s1">'Lampung'</span>                    <span class="o">=&gt;</span> <span class="s1">'ID.LA'</span><span class="p">,</span>
      <span class="s1">'Maluku'</span>                     <span class="o">=&gt;</span> <span class="s1">'ID.MA'</span><span class="p">,</span>
      <span class="s1">'Maluku Utara'</span>               <span class="o">=&gt;</span> <span class="s1">'ID.MU'</span><span class="p">,</span>
      <span class="s1">'Nusa Tenggara Barat'</span>        <span class="o">=&gt;</span> <span class="s1">'ID.NB'</span><span class="p">,</span>
      <span class="s1">'Nusa Tenggara Timur'</span>        <span class="o">=&gt;</span> <span class="s1">'ID.NT'</span><span class="p">,</span>
      <span class="s1">'Papua'</span>                      <span class="o">=&gt;</span> <span class="s1">'ID.PA'</span><span class="p">,</span>
      <span class="s1">'Papua Barat'</span>                <span class="o">=&gt;</span> <span class="s1">'ID.IB'</span><span class="p">,</span>
      <span class="s1">'Riau'</span>                       <span class="o">=&gt;</span> <span class="s1">'ID.RI'</span><span class="p">,</span>
      <span class="s1">'Sulawesi Barat'</span>             <span class="o">=&gt;</span> <span class="s1">'ID.SR'</span><span class="p">,</span>
      <span class="s1">'Sulawesi Selatan'</span>           <span class="o">=&gt;</span> <span class="s1">'ID.SE'</span><span class="p">,</span>
      <span class="s1">'Sulawesi Tengah'</span>            <span class="o">=&gt;</span> <span class="s1">'ID.ST'</span><span class="p">,</span>
      <span class="s1">'Sulawesi Tenggara'</span>          <span class="o">=&gt;</span> <span class="s1">'ID.SG'</span><span class="p">,</span>
      <span class="s1">'Sulawesi Utara'</span>             <span class="o">=&gt;</span> <span class="s1">'ID.SW'</span><span class="p">,</span>
      <span class="s1">'Sumatera Barat'</span>             <span class="o">=&gt;</span> <span class="s1">'ID.SB'</span><span class="p">,</span>
      <span class="s1">'Sumatera Selatan'</span>           <span class="o">=&gt;</span> <span class="s1">'ID.SL'</span><span class="p">,</span>
      <span class="s1">'Sumatera Utara'</span>             <span class="o">=&gt;</span> <span class="s1">'ID.SU'</span>
    <span class="p">}</span>

    <span class="n">provinces</span><span class="p">[</span><span class="n">province_name</span><span class="p">]</span> <span class="k">if</span> <span class="n">provinces</span><span class="p">.</span><span class="nf">include?</span> <span class="n">province_name</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></td></tr></tbody></table></code></pre></figure>

<p>Oke, setelah jadi, tinggal di-include-kan ke data_peta_controller.rb.</p>

<div class="highlight-caption"><span class="label">FILE</span><code>app/controllers/data_peta_controller.rb</code></div>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="code"><pre><span class="k">class</span> <span class="nc">DataPetaController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
  <span class="kp">include</span> <span class="no">ConvertProvNameToProvCode</span>

  <span class="k">def</span> <span class="nf">index</span>
    <span class="c1"># ...</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></td></tr></tbody></table></code></pre></figure>

<p><br /></p>
<h3 id="mengklasifikasi-total_cases-berdasaran-warna">Mengklasifikasi total_cases Berdasaran Warna</h3>

<p>Selanjutnya kita perlu mengklasifikasi jumlah dari <code class="language-plaintext highlighter-rouge">total_cases</code> ke dalam format warna yang tersedia.</p>

<pre class="whiteboard">'AAA': '#DB1836'<br />'BBB': '#F15A23'<br />'CCC': '#F89A1C'<br />'DDD': '#FFD500'<br />'EEE': '#C1D737'<br />'FFF': '#44B549'<br />'GGG': '#0EB049'<br />'HHH': '#016533'<br /></pre>

<p>Anggaplah ‘AAA’ adalah yang paling banyak dan ‘HHH’ yang paling sedikit.</p>

<p>Saya akan menggunakan controller concern lagi yang saya beri nama,</p>

<p><code class="language-plaintext highlighter-rouge">convert_total_cases_to_code(total_cases)</code></p>

<div class="highlight-caption"><span class="label">FILE</span><code>app/controllers/concerns/convert_total_cases_to_code.rb</code></div>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre></td><td class="code"><pre><span class="k">module</span> <span class="nn">ConvertTotalCasesToCode</span>
  <span class="k">def</span> <span class="nf">convert_total_cases_to_code</span><span class="p">(</span><span class="n">total_cases</span><span class="p">)</span>
    <span class="k">case</span> <span class="n">total_cases</span>
    <span class="k">when</span> <span class="mi">200_000</span><span class="o">..</span><span class="mi">300_000</span>
      <span class="s1">'AAA'</span>
    <span class="k">when</span> <span class="mi">150_000</span><span class="o">..</span><span class="mi">200_000</span>
      <span class="s1">'BBB'</span>
    <span class="k">when</span> <span class="mi">90_000</span><span class="o">..</span><span class="mi">150_000</span>
      <span class="s1">'CCC'</span>
    <span class="k">when</span> <span class="mi">70_000</span><span class="o">..</span><span class="mi">90_000</span>
      <span class="s1">'DDD'</span>
    <span class="k">when</span> <span class="mi">50_000</span><span class="o">..</span><span class="mi">70_000</span>
      <span class="s1">'EEE'</span>
    <span class="k">when</span> <span class="mi">30_000</span><span class="o">..</span><span class="mi">50_000</span>
      <span class="s1">'FFF'</span>
    <span class="k">when</span> <span class="mi">10_000</span><span class="o">..</span><span class="mi">30_000</span>
      <span class="s1">'GGG'</span>
    <span class="k">when</span> <span class="mi">100</span><span class="o">..</span><span class="mi">10_000</span>
      <span class="s1">'HHH'</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></td></tr></tbody></table></code></pre></figure>

<p>Oke, setelah jadi, tinggal di-include-kan ke data_peta_controller.rb.</p>

<div class="highlight-caption"><span class="label">FILE</span><code>app/controllers/data_peta_controller.rb</code></div>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="code"><pre><span class="k">class</span> <span class="nc">DataPetaController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
  <span class="kp">include</span> <span class="no">ConvertProvNameToProvCode</span>
  <span class="kp">include</span> <span class="no">ConvertTotalCasesToCode</span>

  <span class="k">def</span> <span class="nf">index</span>
    <span class="c1"># ...</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></td></tr></tbody></table></code></pre></figure>

<p><br /></p>
<h3 id="memberikan-delimiter--untuk-ribuan">Memberikan Delimiter , untuk Ribuan</h3>

<p>Data <strong>total_cases</strong> tidak memiliki format string berupa delimiter koma (,) untuk memberikan kemudahan dalam membaca satuan ribuan dalam nominal angka.</p>

<p>Rails sudah menyediakan helper method untuk menghandle ini namun adanya di view template yang disediakan oleh ActionView yang bernama <code class="language-plaintext highlighter-rouge">number_with_delimiter(number, options = {})</code>.</p>

<p>Apakah bisa digunakan di Controller?</p>

<p>Kalau tidak ada, apakah kita perlu membuat sendiri?</p>

<p>Apakah di ActionController ada juga method helper yang sama?</p>

<p>Mudahnya tinggal kita include saja <code class="language-plaintext highlighter-rouge">ActionView::Helpers::NumberHelper</code>.</p>

<div class="highlight-caption"><span class="label">FILE</span><code>app/controllers/data_peta_controller.rb</code></div>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="code"><pre><span class="k">class</span> <span class="nc">DataPetaController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
  <span class="kp">include</span> <span class="no">ConvertProvNameToProvCode</span>
  <span class="kp">include</span> <span class="no">ConvertTotalCasesToCode</span>
  <span class="kp">include</span> <span class="no">ActionView</span><span class="o">::</span><span class="no">Helpers</span><span class="o">::</span><span class="no">NumberHelper</span>

  <span class="k">def</span> <span class="nf">index</span>
    <span class="c1"># ...</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></td></tr></tbody></table></code></pre></figure>

<p>Selanjutnya tinggal kita gunakan pada object query yang sudah kita racik sebelumnya.</p>

<div class="highlight-caption"><span class="label">FILE</span><code>app/controllers/data_peta_controller.rb</code></div>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="code"><pre><span class="k">class</span> <span class="nc">DataPetaController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
  <span class="kp">include</span> <span class="no">ConvertProvNameToProvCode</span>
  <span class="kp">include</span> <span class="no">ConvertTotalCasesToCode</span>
  <span class="kp">include</span> <span class="no">ActionView</span><span class="o">::</span><span class="no">Helpers</span><span class="o">::</span><span class="no">NumberHelper</span>

  <span class="k">def</span> <span class="nf">index</span>
    <span class="vi">@last_updated</span>     <span class="o">=</span> <span class="no">Province</span><span class="p">.</span><span class="nf">last</span><span class="p">.</span><span class="nf">fetched_at</span>
    <span class="vi">@cumulative_cases</span> <span class="o">=</span> <span class="no">Province</span><span class="p">.</span><span class="nf">select</span><span class="p">(</span><span class="ss">:name</span><span class="p">,</span> <span class="ss">:total_cases</span><span class="p">)</span>
      <span class="p">.</span><span class="nf">where</span><span class="p">(</span><span class="ss">fetched_at: </span><span class="vi">@last_updated</span><span class="p">)</span>
      <span class="p">.</span><span class="nf">map</span> <span class="p">{</span> <span class="o">|</span><span class="n">n</span><span class="o">|</span>
        <span class="s2">"'</span><span class="si">#{</span><span class="n">convert_name_to_province_code</span><span class="p">(</span><span class="n">n</span><span class="p">.</span><span class="nf">name</span><span class="p">)</span><span class="si">}</span><span class="s2">': {fillKey: '</span><span class="si">#{</span><span class="n">convert_total_cases_to_code</span><span class="p">(</span><span class="n">n</span><span class="p">.</span><span class="nf">total_cases</span><span class="p">)</span><span class="si">}</span><span class="s2">', totalCases: '</span><span class="si">#{</span><span class="n">number_with_delimiter</span><span class="p">(</span><span class="n">n</span><span class="p">.</span><span class="nf">total_cases</span><span class="p">,</span> <span class="ss">delimiter: </span><span class="s1">','</span><span class="p">)</span><span class="si">}</span><span class="s2">'},</span><span class="se">\n</span><span class="s2">"</span>
      <span class="p">}.</span><span class="nf">join</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></td></tr></tbody></table></code></pre></figure>

<p>Instance variable <code class="language-plaintext highlighter-rouge">@cumulative_cases</code> inilah yang akan kita gunakan pada view template.</p>

<h2 id="actionview">ActionView</h2>

<p>Setelah selesai membuat object query di controller, selanjutnya tinggal kita gunakan di view template.</p>

<p>Tapi sebelumnya, kita perlu untuk menyiapkan beberapa Javascript library yang akan diperlukan oleh datamaps.</p>

<ol>
  <li>
    <p><a href="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.3/d3.min.js" target="_blank"><strong>d3.min.js</strong></a></p>
  </li>
  <li>
    <p><a href="https://cdnjs.cloudflare.com/ajax/libs/topojson/1.6.9/topojson.min.js" target="_blank"><strong>topojson.min.js</strong></a></p>
  </li>
  <li>
    <p><a href="https://cdnjs.cloudflare.com/ajax/libs/datamaps/0.5.9/datamaps.idn.min.js" target="_blank"><strong>datamaps.idn.min.js</strong></a>, saya menggunakan datamaps wilayah Indonesia.</p>
  </li>
</ol>

<p>Kita akan letakkan pada direktori <strong>vendor/assets/javascripts/</strong> saja.</p>

<pre>
.
├─ app/
├─ bin/
├─ config/
├─ db/
├─ lib/
├─ log/
├─ node_modules/
├─ public/
├─ spec/
├─ storage/
├─ tmp/
├─ vendor/
│   └─ assets/
│      └─ javascripts/
│         ├─ <mark>d3.min.js</mark>
│         ├─ <mark>topojson.min.js</mark>
│         └─ <mark>datamaps.idn.min.js</mark>
│
├─ Gemfile
...
</pre>

<p>Buatkan struktur seperti di atas.</p>

<p>Kemudian, kita akan masukkan kepada daftar assets precompile, di <strong>config/initializers/assets.rb</strong>.</p>

<div class="highlight-caption"><span class="label">FILE</span><code>config/initializers/assets.rb</code></div>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="code"><pre><span class="c1"># Be sure to restart your server when you modify this file.</span>

<span class="c1"># ...</span>

<span class="c1"># Precompile additional assets.</span>
<span class="c1"># application.js, application.css, and all non-JS/CSS in the app/assets</span>
<span class="c1"># folder are already added.</span>
<span class="no">Rails</span><span class="p">.</span><span class="nf">application</span><span class="p">.</span><span class="nf">config</span><span class="p">.</span><span class="nf">assets</span><span class="p">.</span><span class="nf">precompile</span> <span class="o">+=</span> <span class="sx">%w(
  d3.min.js topojson.min.js datamaps.idn.min.js
)</span>
</pre></td></tr></tbody></table></code></pre></figure>

<p>Tambahkan seperti pada baris 8, 9, 10.</p>

<p>Mantap!</p>

<p>Sekarang kita lanjut ke view template.</p>

<div class="highlight-caption"><span class="label">FILE</span><code>app/views/data_peta/index.html.erb</code></div>

<figure class="highlight"><pre><code class="language-eruby" data-lang="eruby"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
</pre></td><td class="code"><pre><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"container px-0 pt-2 pb-5 mt-5"</span> <span class="na">style=</span><span class="s">"overflow-y: auto"</span><span class="nt">&gt;</span>
  <span class="cp">&lt;%=</span> <span class="n">javascript_include_tag</span> <span class="s1">'d3.min'</span> <span class="cp">%&gt;</span>
  <span class="cp">&lt;%=</span> <span class="n">javascript_include_tag</span> <span class="s1">'topojson.min'</span> <span class="cp">%&gt;</span>
  <span class="cp">&lt;%=</span> <span class="n">javascript_include_tag</span> <span class="s1">'datamaps.idn.min'</span> <span class="cp">%&gt;</span>

  <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"container1"</span> <span class="na">style=</span><span class="s">"position: relative; width: 1100px; height: 400px; margin: 0 auto;"</span><span class="nt">&gt;&lt;/div&gt;</span>

  <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;</span>
    <span class="c1">//basic map config with custom fills, mercator projection</span>
    <span class="kd">var</span> <span class="nx">map</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Datamap</span><span class="p">({</span>
      <span class="na">scope</span><span class="p">:</span> <span class="dl">'</span><span class="s1">idn</span><span class="dl">'</span><span class="p">,</span>
      <span class="na">element</span><span class="p">:</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">'</span><span class="s1">container1</span><span class="dl">'</span><span class="p">),</span>
      <span class="na">setProjection</span><span class="p">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">element</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">projection</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">geo</span><span class="p">.</span><span class="nx">mercator</span><span class="p">()</span>
          <span class="p">.</span><span class="nx">center</span><span class="p">([</span><span class="mi">115</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">])</span>
          <span class="p">.</span><span class="nx">rotate</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
          <span class="p">.</span><span class="nx">scale</span><span class="p">(</span><span class="mi">3900</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span>
        <span class="kd">var</span> <span class="nx">path</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">geo</span><span class="p">.</span><span class="nx">path</span><span class="p">()</span>
          <span class="p">.</span><span class="nx">projection</span><span class="p">(</span><span class="nx">projection</span><span class="p">);</span>
        <span class="k">return</span> <span class="p">{</span><span class="na">path</span><span class="p">:</span> <span class="nx">path</span><span class="p">,</span> <span class="na">projection</span><span class="p">:</span> <span class="nx">projection</span><span class="p">};</span>
      <span class="p">},</span>
      <span class="na">fills</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">defaultFill</span><span class="p">:</span> <span class="dl">'</span><span class="s1">#dddddd</span><span class="dl">'</span><span class="p">,</span>
        <span class="dl">'</span><span class="s1">AAA</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">#DB1836</span><span class="dl">'</span><span class="p">,</span>
        <span class="dl">'</span><span class="s1">BBB</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">#F15A23</span><span class="dl">'</span><span class="p">,</span>
        <span class="dl">'</span><span class="s1">CCC</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">#F89A1C</span><span class="dl">'</span><span class="p">,</span>
        <span class="dl">'</span><span class="s1">DDD</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">#FFD500</span><span class="dl">'</span><span class="p">,</span>
        <span class="dl">'</span><span class="s1">EEE</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">#C1D737</span><span class="dl">'</span><span class="p">,</span>
        <span class="dl">'</span><span class="s1">FFF</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">#44B549</span><span class="dl">'</span><span class="p">,</span>
        <span class="dl">'</span><span class="s1">GGG</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">#0EB049</span><span class="dl">'</span><span class="p">,</span>
        <span class="dl">'</span><span class="s1">HHH</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">#016533</span><span class="dl">'</span><span class="p">,</span>
      <span class="p">},</span>
      <span class="na">data</span><span class="p">:</span> <span class="p">{</span>
        <span class="cp">&lt;%=</span> <span class="n">raw</span> <span class="vi">@cumulative_cases</span> <span class="cp">%&gt;</span>
      <span class="p">},</span>
      <span class="na">geographyConfig</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">popupTemplate</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">geo</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">return</span> <span class="p">[</span><span class="dl">'</span><span class="s1">&lt;div class="hoverinfo"&gt;&lt;strong&gt;</span><span class="dl">'</span><span class="p">,</span>
            <span class="nx">geo</span><span class="p">.</span><span class="nx">properties</span><span class="p">.</span><span class="nx">name</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">&lt;/strong&gt;&lt;br&gt;Kasus (Kulumatif)</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">: </span><span class="dl">'</span> <span class="o">+</span> <span class="nx">data</span><span class="p">.</span><span class="nx">totalCases</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">&lt;/div&gt;</span><span class="dl">'</span><span class="p">].</span><span class="nx">join</span><span class="p">(</span><span class="dl">''</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">});</span>
  <span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</pre></td></tr></tbody></table></code></pre></figure>

<p>Baris 2, 3, 4, adalah cara memanggil Javascript library yang kita masukkan ke dalam direktori vendor sebelumnya.</p>

<p>Baris 34, adalah cara memanggil instance variable <code class="language-plaintext highlighter-rouge">@cumulative_cases</code> yang telah kita buat object querynya di <strong>app/controllers/data_peta_controller.rb</strong>.</p>

<p>Selesai!</p>

<p>Hanya seperti itu saja.</p>

<p>Apabila dirasa ada yan kurang pas, teman-teman bisa memodifikiasi dan memperbaiki sesuai keinginan.</p>

<h1 id="pesan-penulis">Pesan Penulis</h1>

<p>Sepertinya, segini dulu yang dapat saya tuliskan.</p>

<p>Mudah-mudahan dapat bermanfaat.</p>

<p>Terima kasih.</p>

<p>(^_^)</p>

<h1 id="referensi">Referensi</h1>

<ol>
  <li>
    <p><a href="https://github.com/markmarkoh/datamaps" target="_blank">github.com/markmarkoh/datamaps</a>
<br />Diakses tanggal: 2021/02/07</p>
  </li>
  <li>
    <p><a href="http://datamaps.github.io/" target="_blank">http://datamaps.github.io/</a>
<br />Diakses tanggal: 2021/02/07</p>
  </li>
  <li>
    <p><a href="https://github.com/d3/d3" target="_blank">github.com/d3/d3</a>
<br />Diakses tanggal: 2021/02/07</p>
  </li>
  <li>
    <p><a href="https://api.rubyonrails.org/classes/ActionView/Helpers/NumberHelper.html#method-i-number_with_delimiter" target="_blank">api.rubyonrails.org/classes/ActionView/Helpers/NumberHelper.html#method-i-number_with_delimiter</a>
<br />Diakses tanggal: 2021/02/07</p>
  </li>
</ol>
</p>

          <!-- wip -->
          
            <br>
          

          <!-- License -->
          
            <div style="text-align:center; margin:0 0 10px 0;"></div>
            
              <div class="noselect">
<h1 style="font-size:2em;">Lisensi</h1>
<div class="ccbysa-img noselect"><img class="ccbysa-img-img" style="margin-top: 5px;" src="/assets/img/logo/cc-by-nc-sa.png" alt="logo_cc-by-nc-sa"/></div><!-- ccbysa -->
<div class="ccbysa-text noselect">
Tulisan ini dilisensikan dengan :<br>
<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.id" target="_blank">Atribusi-NonKomersial-BerbagiSerupa 4.0 Internasional (CC BY-NC-SA 4.0)</a>
</div><!-- ccbysa-text -->
</div>

            
          

          <div style="clear:both;"></div>

          <!-- Penulis -->
          
            <div style="text-align:center; margin:0 0 10px 0;"></div>

            

            
              <div class="noselect">
  <h1 style="font-size:2em;">Penulis</h1>
  
  
    
      <div class="penulis-img">
        <img style="margin:0 auto;border-radius:50%;" src="https://github.com/bandithijo.png?size=200" alt="bandithijo" onerror="imgError(this);">
      </div><!-- penulis-img -->

      <div class="penulis-text">
        <p><p><b>BanditHijo</b> adalah nama pena saya –meminjam istilah keren dari para penulis. Teman-teman menyebut saya sebagai GNU/Linux Enthusiast. Saya memang gemar mengutak-atik sistem operasi ini. Sistem operasi ini memberikan saya kebebasan untuk mengekspresikan ide-ide dalam membantu menyelesaikan pekerjaan saya sehari-hari.</p></p>
        <p style="text-align:right;">- <b>Rizqi Nur Assyaufi</b></p>
      </div><!-- penulis-text -->
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
</div>

            
          

          <div style="clear:both;"></div>

          

        </div><!-- markdown-body -->
      </article>

      <article>
        <div class="post-body-sidebar">
          <aside class="sidebar noselect" id="sidebar-tail">

    <div class="sidebar-body">
  <h1 style="font-size:1.5em;border-bottom:1px dashed #9E9E9E;">
    <img src="/assets/img/logo/logo_terbaru.svg">Tulisan Terbaru
  </h1>
  <div class="toc">
  <ul>
  
  
    
      <li><a href="/blog/mudah-mengenkripsi-file-dokumen-dengan-gnupg">Mudah Mengenkripsi File dan Dokumen dengan GnuPG (GPG)</a></li>
    
  
    
      <li><a href="/blog/dmenu-websearch-jalan-pintas-pencari-kata-yang-praktis">dmenu-websearch, Jalan Pintas Pencari Kata yang Praktis</a></li>
    
  
    
      <li><a href="/blog/sxiv-simple-x-image-viewer-yang-praktis">sxiv, Simple X Image Viewer (sxiv) yang Praktis namun Powerfull</a></li>
    
  
    
      <li><a href="/blog/presentation-mode-dengan-dpms-di-linux">Membuat Presentation Mode tanpa XFCE4 Power Manager di GNU/Linux (Bonus! dmenu-presentationmode)</a></li>
    
  
    
      <li><a href="/blog/bluetooth-headset-battery-status">Bluetooth Headset Battery Status</a></li>
    
  
    
      <li><a href="/blog/berdonasi-ke-project-open-source-yang-digunakan">Hanya dengan 100 Ribu Rupiah, Bisa Berdonasi ke 6 Open Source Project!</a></li>
    
  
    
      <li><a href="/blog/menjalankan-distro-linux-lain-dengan-distrobox-di-fedora-linux">Menjalankan Distro Linux yang Lain dengan Distrobox di Fedora Linux</a></li>
    
  
    
      <li><a href="/blog/datetimepicker-dengan-tempusdominus-bootstrap-4-dan-simple-form-di-rails">Date Time Picker dengan Tempus Dominus Bootstrap 4 dan simple_form di Ruby on Rails 6</a></li>
    
  
    
      <li><a href="/blog/datetimepicker-dengan-tempusdominus-bootstrap-4-di-rails">Date Time Picker dengan Tempus Dominus Bootstrap 4 di Ruby on Rails 6</a></li>
    
  
    
      <li><a href="/blog/lazygit-terminal-user-interface-untuk-git">Lazygit, Terminal User Interface untuk Git Commands</a></li>
    
  
  </ul>
  </div>
  <div style="margin:10px 0 10px 0;border-bottom:1px dashed #9E9E9E;"></div>
  <p style="text-align:left;"><a style="border-bottom:0;" href="/blog/"><b>Selengkapnya >></b></a></p>
</div>

    <div class="sidebar-body">
  <h1 style="font-size:1.5em;border-bottom:1px dashed #9E9E9E;">
    <img src="/assets/img/logo/logo_tags.svg"><a style="color:#000;border-bottom:none;" href="/tags/">Tags</a>
  </h1>
  <div class="toc">
    
    
      
        
        <span class="tags"><a href="/tags/#android">Android</a></span>
      
        
        <span class="tags"><a href="/tags/#arch-linux">Arch Linux</a></span>
      
        
        <span class="tags"><a href="/tags/#artix-linux">Artix Linux</a></span>
      
        
        <span class="tags"><a href="/tags/#bootstrap">Bootstrap</a></span>
      
        
        <span class="tags"><a href="/tags/#container">Container</a></span>
      
        
        <span class="tags"><a href="/tags/#database">Database</a></span>
      
        
        <span class="tags"><a href="/tags/#docker">Docker</a></span>
      
        
        <span class="tags"><a href="/tags/#event">Event</a></span>
      
        
        <span class="tags"><a href="/tags/#fedora">Fedora</a></span>
      
        
        <span class="tags"><a href="/tags/#freebsd">FreeBSD</a></span>
      
        
        <span class="tags"><a href="/tags/#git">Git</a></span>
      
        
        <span class="tags"><a href="/tags/#heroku">Heroku</a></span>
      
        
        <span class="tags"><a href="/tags/#i3wm">I3WM</a></span>
      
        
        <span class="tags"><a href="/tags/#java">Java</a></span>
      
        
        <span class="tags"><a href="/tags/#javascript">Javascript</a></span>
      
        
        <span class="tags"><a href="/tags/#jekyll">Jekyll</a></span>
      
        
        <span class="tags"><a href="/tags/#kvm">KVM</a></span>
      
        
        <span class="tags"><a href="/tags/#mysql">MySQL</a></span>
      
        
        <span class="tags"><a href="/tags/#network">Network</a></span>
      
        
        <span class="tags"><a href="/tags/#osx">OSX</a></span>
      
        
        <span class="tags"><a href="/tags/#podman">Podman</a></span>
      
        
        <span class="tags"><a href="/tags/#postgresql">PostgreSQL</a></span>
      
        
        <span class="tags"><a href="/tags/#python">Python</a></span>
      
        
        <span class="tags"><a href="/tags/#qemu">Qemu</a></span>
      
        
        <span class="tags"><a href="/tags/#rspec">RSpec</a></span>
      
        
        <span class="tags"><a href="/tags/#rails">Rails</a></span>
      
        
        <span class="tags"><a href="/tags/#ruby">Ruby</a></span>
      
        
        <span class="tags"><a href="/tags/#script">Script</a></span>
      
        
        <span class="tags"><a href="/tags/#security">Security</a></span>
      
        
        <span class="tags"><a href="/tags/#terminal">Terminal</a></span>
      
        
        <span class="tags"><a href="/tags/#thinkpad">ThinkPad</a></span>
      
        
        <span class="tags"><a href="/tags/#tips">Tips</a></span>
      
        
        <span class="tags"><a href="/tags/#tools">Tools</a></span>
      
        
        <span class="tags"><a href="/tags/#ulasan">Ulasan</a></span>
      
        
        <span class="tags"><a href="/tags/#vim">Vim</a></span>
      
        
        <span class="tags"><a href="/tags/#virt-manager">Virt-Manager</a></span>
      
        
        <span class="tags"><a href="/tags/#wine">Wine</a></span>
      
        
        <span class="tags"><a href="/tags/#xfce">XFCE</a></span>
      
        
        <span class="tags"><a href="/tags/#jquery">jQuery</a></span>
      
        
        <span class="tags"><a href="/tags/#opensuse">openSUSE</a></span>
      
        
        <span class="tags"><a href="/tags/#ssh">ssh</a></span>
      
    
    
  </div><!-- toc -->
</div><!-- sidebar-body -->

    <div class="sidebar-body">
  <h1 style="font-size:1.5em;border-bottom:1px dashed #9E9E9E;margin-bottom:5px;">
    <img src="/assets/img/logo/logo_dotfriends.svg">dotFriends
  </h1>
  <!-- untuk random dotfriends list sebanyak 8 -->
  
  
    
        <p>+&nbsp;<a href="https://github.com/fikriomar16" target="_blank">Fikri Omar</a></p>
    
        <p>+&nbsp;<a href="https://ypraw.github.io/" target="_blank">ypraw</a></p>
    
        <p>+&nbsp;<a href="https://muktazam.me" target="_blank">reorr</a></p>
    
        <p>+&nbsp;<a href="https://www.linuxisekai.site" target="_blank">Galih Wisnuaji</a></p>
    
        <p>+&nbsp;<a href="https://didik.id" target="_blank">Didik Wicaksono</a></p>
    
  
  <p style="font-size:10px;color:#00603C;margin-top:12px;text-align:left;">*5 daftar blog di atas digenerate secara random</p>
  <div style="margin:10px 0 10px 0;border-bottom:1px dashed #9E9E9E;"></div>
  <p style="text-align:left;"><a style="border-bottom:0;" href="/dotfriends/"><b>Selengkapnya >></b></a></p>
</div>

    <div class="sidebar-body-rss"">
  <h1 style="border-bottom:1px dashed #ACA573;margin-bottom:5px;">
    <img src="/assets/img/logo/logo_bantuan.svg">Bantuan
  </h1>
   <p>Kebingungan dengan simbol-simbol yang terdapat pada halaman blog ini?</p>
   <p>Kamu dapat mempelajari bagaimana cara membaca setiap komponen yang ada di dalam blog, <a href="/bantuan/"><b>di sini</b></a>.</p>
</div>

    <div class="sidebar-body-rss">
  <h1 style="font-size:1.5em;border-bottom:1px dashed #ACA573;margin-bottom:5px;">
    <img src="/assets/img/logo/logo_rss.svg">Berlangganan RSS
  </h1>
  <p>Untuk dapat berlangganan catatan/post terbaru, kamu dapat mengklik tombol RSS yang terdapat di <a href="#footer"><b>footer</b></a>.</p>
  <p>Blog ini memiliki <del>dua</del> satu buah RSS feed, Blog dan <del>Vlog</del>.</p>
  <p>Apabila kamu mengklik tombol RSS yang ada pada halaman yang berkategori Blog, maka RSS feed url yang keluar adalah untuk kategori Blog, begitu pula sebaliknya untuk halaman Vlog.</p>
  <div style="margin:15px 0 10px 0;border-bottom:1px dashed #ACA573;"></div>
  <p>Belum tahu tentang RSS? Yuk, <a href="https://bandithijo.dev/blog/newsboat-rss-feed-reader"><b>ke sini</b></a></p>
</div>


</aside>

        </div>
      </article>

    </div><!-- container-edge-border -->
  </div><!-- main container -->
</section><!-- main -->


<footer id="footer" class="noselect">
  <div class="container">
    <div class="container-inner">
      <div class="footer-line">
        <p style="font-size:20px;"><a href="/"><strong>BanditHijo (R)-Chive</strong></a> &copy; 2012 - 2022</p>
        <p style="font-size:12px;margin-top:-35px;color:#404040;">
          Source code dan artikel-artikel ditulis menggunakan <span class="nobr"><a href="http://vim.org" target="_blank" rel="noreferrer" style="font-weight:bold;color:#404040;">Vim</a> text editor.</span><br>
          Semua elemen gambar dikerjakan menggunakan <span class="nobr"><a href="https://inkscape.org" target="_blank" rel="noreferrer" style="font-weight:bold;color:#404040;">Inkscape</a> dan <a href="https://gimp.org" target="_blank" rel="noreferrer" style="font-weight:bold;color:#404040;">GIMP</a>.</span><br>
          Menggunakan <a href="https://jekyllrb.com" target="_blank" rel="noreferrer" style="font-weight:bold;color:#404040;">Jekyll</a> sebagai Static Site Generator.<br>
          Dihosting menggunakan <a href="https://github.com/bandithijo/bandithijo.github.io" target="_blank" rel="noreferrer" style="font-weight:bold;color:#404040;">GitHub</a>.<br>
          Terakhir update: <b>23/09/2022</b>
        </p>
        <p class="footer-menu">
          <br>
          <a href="/contact/"><strong>Contact</strong></a> |&nbsp;
          <a href="https://twitter.com/bandithijo" target="_blank" rel="noreferrer"><strong>Twitter</strong></a> |&nbsp;
          <a rel="me" href="https://www.youtube.com/c/BanditHijo" target="_blank" rel="noreferrer"><strong>YouTube</strong></a> |&nbsp;
          <a rel="me" href="https://github.com/bandithijo" target="_blank" rel="noreferrer"><strong>GitHub</strong></a> |&nbsp;
          
            <a href="/feed/blog.xml" target="_blank"><strong>RSS</strong></a>
          
        </p>

        
        
        
        
        
        
        
        
        
        
        
        
        
        

        <div class="tech-i-used-desktop">
          <a href="https://jekyllrb.com" target="_blank" rel="noopener">
            <img class="footer-img-jekyll" src="/assets/img/logo/logo_jekyll.png">
          </a>
          <a href="https://www.ruby-lang.org" target="_blank" rel="noopener">
            <img class="footer-img-ruby" src="/assets/img/logo/logo_ruby.png">
          </a>
          <a href="https://netlify.app" target="_blank" rel="noopener">
            <img class="footer-img-netlify" src="/assets/img/logo/logo_netlify.png">
          </a>
          
          
          
          
          
          
        </div><!-- tech-i-used-desktop -->

        <div class="tech-i-used-mobile">
          
          
          
          
          
          
          
          
          
          <a href="https://netlify.app" target="_blank" rel="noopener" rel="noreferrer">
            <img class="footer-img-netlify-mobile" src="/assets/img/logo/logo_netlify_mobile.png">
          </a>
          <a href="https://www.ruby-lang.org" target="_blank" rel="noopener" rel="noreferrer">
            <img class="footer-img-ruby-mobile" src="/assets/img/logo/logo_ruby_mobile.png">
          </a>
          <a href="https://jekyllrb.com/" target="_blank" rel="noopener" rel="noreferrer">
            <img class="footer-img-jekyll-mobile" src="/assets/img/logo/logo_jekyll_mobile.png">
          </a>
        </div><!-- tech-i-used-mobile -->
      </div><!-- footer-line -->
    </div><!-- container-innner -->
  </div><!-- footer container -->
</footer>

<!-- site.git.build_version -->
<div class="tech-i-used-desktop" style="text-align:center;font-size:9px;color:#8F8879;margin: -5px 0 10px 0;">
  
</div>
<!-- END site.git.build_version -->

<script type="text/javascript" src="/assets/js/nav.js"></script>
<script type="text/javascript" src="/assets/js/lazyload.js"></script>
<script type="text/javascript" src="/assets/js/headings-permalink.js"></script>


<script type="text/javascript" src="/assets/js/aside.js"></script>


<script type="text/javascript" src="/assets/js/enlarge-image-modal.js"></script>




</body>
</html>
